{% extends './basic/base.html' %} {% block content %}
<header class="header">
  <nav
    class="nav"
    style="
      margin-top: 10px;
      border-bottom: solid 1px black;
      background-color: #444;
    "
  >
    <a href="/">
      <img
        src="../static/logo-white.png"
        alt="club logo"
        class="nav__logo"
        id="logo"
      />
    </a>
    <ul class="nav__links">
      <li class="nav__item">
        <a class="nav__link nav__link--btn" href="/login" style="color: white"
          >Log in</a
        >
      </li>
      <li class="nav__item">
        <a
          class="nav__link nav__link--btn"
          href="/register"
          style="color: white; border: 1px solid white"
          >Sign Up</a
        >
      </li>
    </ul>
  </nav>

  <div
    style="
      margin: 140px;
      background-color: #fff;

      width: 446px;

      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding-bottom: 50px;
      max-height: 100vh;
    "
  >
    <h2
      style="
        font-size: 2.5rem;
        text-transform: uppercase;
        font-weight: 700;
        line-height: 1.3;
        color: #28b487;
        padding-top: 30px;
      "
    >
      Register New Member
    </h2>

    {% if step == 1 %}
    <form
      action="/register"
      method="POST"
      style="font-size: 16px; margin-right: 80px; padding-top: 20px"
    >
      <div class="session1">
        <div>
          <p style="font-weight: bold">Step 1: Account information</p>
          <label for="username" style="font-weight: bold; display: block"
            >Username :</label
          >
          <input
            type="text"
            name="username"
            style="background-color: #f2f2f2; width: 200px"
            required
          />
        </div>
        <div style="margin-top: 30px">
          <label for="email" style="font-weight: bold; display: block"
            >Email :</label
          >
          <input
            type="text"
            name="email"
            required
            style="background-color: #f2f2f2"
          />
        </div>
        <div style="margin-top: 30px">
          <label for="password" style="font-weight: bold; display: block"
            >Password :</label
          >
          <input
            type="password"
            name="password"
            required
            style="background-color: #f2f2f2"
          />
        </div>
        <div style="margin-top: 30px">
          <label for="conpassword" style="font-weight: bold; display: block"
            >Comfirm Password :</label
          >
          <input
            type="password"
            name="conpassword"
            style="background-color: #f2f2f2"
            required
          />
        </div>
        <div style="margin-top: 30px">
          <p style="color: red; padding-bottom: 5px; width: 200px">{{msg}}</p>
          <button
            type="submit"
            style="
              border: none;
              border-radius: 10rem;
              width: 120px;
              height: 50px;
              background-color: #55c57a;
              color: #fff;
              font-size: 20px;
            "
          >
            Next
          </button>
        </div>
      </div>
    </form>

    {% endif %} {% if step == 2 %}
    <form
      action="/register"
      method="POST"
      style="font-size: 16px; margin-right: 80px; padding-top: 20px"
    >
      <div class="session2">
        <div>
          <p style="font-weight: bold">Step 2: Personal information</p>

          <label for="first_name" style="font-weight: bold; display: block"
            >Title :</label
          >
          <select
            name="title"
            style="background-color: #f2f2f2; padding: 5px; width: 200px"
          >
            <option value="Mr">Mr</option>
            <option value="Mrs.">Mrs.</option>
            <option value="Ms">Ms</option>
            <option value="Miss">Misss</option>
          </select>
        </div>

        <div style="margin-top: 20px">
          <label for="first_name" style="font-weight: bold; display: block"
            >First Name :</label
          >
          <input
            type="text"
            name="first_name"
            style="background-color: #f2f2f2; width: 200px"
            pattern="[A-Za-z]+"
            title="Please enter letters only"
            required
          />
        </div>
        <div style="margin-top: 20px">
          <label for="email" style="font-weight: bold; display: block"
            >Last Name :</label
          >
          <input
            type="text"
            name="last_name"
            required
            style="background-color: #f2f2f2"
            pattern="[A-Za-z]+"
            title="Please enter letters only"
          />
        </div>
        <div style="margin-top: 20px">
          <label for="position" style="font-weight: bold; display: block"
            >Position :</label
          >
          <input
            type="text"
            name="position"
            required
            style="background-color: #f2f2f2"
            pattern="[A-Za-z]+"
            title="Please enter letters only"
          />
        </div>
        <div style="margin-top: 20px">
          <label for="phone" style="font-weight: bold; display: block"
            >Phone Number :</label
          >
          <input
            type="text"
            name="phone"
            style="background-color: #f2f2f2"
            required
            minlength="9"
            maxlength="11"
          />
        </div>

        <div style="margin-top: 20px">
          <label for="address" style="font-weight: bold; display: block"
            >Address :</label
          >
          <input
            type="text"
            name="address"
            style="background-color: #f2f2f2"
            required
          />
        </div>

        <div style="margin-top: 20px">
          <label for="password" style="font-weight: bold; display: block"
            >Date of Birth :</label
          >
          <input
            type="date"
            name="birth"
            style="background-color: #f2f2f2"
            required
            id="birth-input"
          />
        </div>
        <input
          type="text"
          name="email"
          value="{{email}}"
          style="display: none"
        />
        <input
          type="text"
          name="username"
          value="{{username}}"
          style="display: none"
        />
        <button
          type="submit"
          style="
            margin-top: 40px;
            border: none;
            border-radius: 10rem;
            width: 120px;
            height: 50px;
            background-color: #55c57a;
            color: #fff;
            font-size: 20px;
          "
        >
          Next
        </button>
      </div>
    </form>

    {% endif %} {% if step == 3 %}
    <form
      action="/register"
      method="POST"
      style="font-size: 16px; margin-right: 80px; padding-top: 20px"
    >
      <div class="session3">
        
        <p style="font-weight: bold">Step 3: Payment</p>

        <div id="planInput">
          <label for="first_name" style="font-weight: bold; display: block"
            >Plan :</label
          >
          <select
            name="plan"
            id="plan"
            style="background-color: #f2f2f2; padding: 5px; width: 200px"
          >
            <option value="monthly">Monthly</option>
            <option value="annual">Annual</option>
          </select>
        </div>
        <div style="margin-top: 30px" id="priceInput">
          <label for="price" style="font-weight: bold; display: block"
            >Price :</label
          >
          <input
            type="text"
            name="price"
            id="price"
            required
            style="background-color: #f2f2f2"
            style="padding-left: 13px"
          />
          <input
        type="text"
        name="username"
        value="{{username}}"
        style="display: none"
      />
        </div>
          <h2
            id="message"
            style="display: none; color: red; margin-top: 10px"
          ></h2>

          <button
            id="submit-btn"
            type="submit"
            style="
              margin-top: 40px;
              border: none;
              border-radius: 10rem;
              width: 120px;
              height: 50px;
              background-color: #55c57a;
              color: #fff;
              font-size: 20px;
              display: none;
            "
          >
            Register
          </button>
   
      </div>
    </form>

    <form style="font-size: 16px; margin-right: 80px; padding-top: 20px" id="cardInfo">
      <div >
        <label for="card" style="font-weight: bold;display: block;"
          >Bank Card :</label
        >
        <input
          type="text"
          name="bankcard"
          pattern="\d{16}"
          title="Please enter a 16-digit bank card number."
          placeholder="16-digit bank card number"
          required
          style="background-color: #f2f2f2"
          style="padding-left: 13px"
        />
      </div>
      <div style="margin-top: 30px">
        <label for="expire" style="font-weight: bold;display: block;"
          >Expire Day :</label
        >
        <input
          type="text"
          name="expiration"
          placeholder="mm/yy"
          pattern="(0[1-9]|1[0-2])\/\d{2}"
          title="Please enter the expiration date in mm/yy format."
          required
          style="background-color: #f2f2f2"
          style="padding-left: 13px"
          oninput="validateExpirationDate(this)"
        />
      </div>
      <div style="margin-top: 30px">
        <label for="code" style="font-weight: bold;display: block;"
          >Security Code :</label
        >
        <input
          type="text"
          name="security"
          placeholder="xxx"
          pattern="\d{3}"
          title="Please enter a 3-digit security code."
          required
          style="background-color: #f2f2f2"
          style="padding-left: 13px"
        />
      </div>

      <div>
        <button
          id="pay-btn"
          type="submit"
          style="
            margin-top: 40px;
            border: none;
            border-radius: 10rem;
            width: 150px;
            height: 50px;
            background-color: #55c57a;
            color: #fff;
            font-size: 20px;
          "
        >
          Pay
        </button>

    </form>

    {% endif %}
  </div>

  <script>
    if (document.getElementById("plan")) {
      const plan = document.getElementById("plan");
      const price = document.getElementById("price");

      price.value = "200";

      plan.addEventListener("change", function () {
        if (plan.value === "monthly") {
          price.value = "200";
        } else if (plan.value === "annual") {
          price.value = "2000";
        }
      });
    }

    if (document.getElementById("birth-input")) {
    const today = new Date(); 
    const maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate()); // 当前日期减去18年

    const maxDateString = maxDate.toISOString().split("T")[0]; 

    document.getElementById("birth-input").setAttribute("max", maxDateString);
    }

    if (document.getElementById("cardInfo")) {
      
      document.getElementById("cardInfo").addEventListener('submit',function(e){
        e.preventDefault()

        const payButton = document.getElementById("pay-btn");
        const submitButton = document.getElementById("submit-btn");
        const message = document.getElementById("message");
        const selectElement = document.getElementById('plan');
        const planInput = document.getElementById('planInput');
        const priceInput = document.getElementById('priceInput');

        payButton.textContent = "Processing....";

        
        setTimeout(function () {
          payButton.style.display = "none";
          document.getElementById("cardInfo").style.display='none'
          planInput.style.display='none'
          priceInput.style.display='none'
          message.textContent = "Payment sucessful!";
          message.style.display = "block";
          submitButton.style.display = "block";
        }, 1500);

      })
    }

    function validateExpirationDate(input) {
    var today = new Date();
    var inputParts = input.value.split("/");
    var inputMonth = parseInt(inputParts[0], 10);
    var inputYear = parseInt(inputParts[1], 10);

    if (
      inputYear < today.getFullYear() - 2000 ||
      (inputYear === today.getFullYear() - 2000 &&
        inputMonth < today.getMonth() + 1)
    ) {
      input.setCustomValidity("Please input a correct expire day.");
    } else {
      input.setCustomValidity("");
    }
  }
  </script>
</header>
{% endblock %}
